import { useState } from "react";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Slider } from "@/components/ui/slider";
import { motion } from "framer-motion";
import { Brain, Network, Play, Wand2 } from "lucide-react";

export default function FlowForgeCanvas() {
  const [mode, setMode] = useState("build");

  const nodes = [
    { id: 1, name: "Offer Accepted", x: 80, y: 150, lever: "manual", ai: "none" },
    { id: 2, name: "Provision Equipment", x: 350, y: 150, lever: "shared", ai: "orchestrator" },
    { id: 3, name: "Orientation", x: 600, y: 150, lever: "dynamic", ai: "advisor" }
  ];

  return (
    <div className="w-full h-screen bg-neutral-50 flex flex-col">
      {/* Top bar */}
      <div className="flex items-center justify-between p-3 border-b bg-white shadow-sm">
        <div className="text-xl font-semibold">FlowForge</div>
        <div className="flex gap-2">
          {['build','augment','reshuffle','simulate'].map(m => (
            <Button key={m} variant={mode===m?'default':'outline'} size="sm" onClick={()=>setMode(m)}>
              {m.charAt(0).toUpperCase()+m.slice(1)}
            </Button>
          ))}
        </div>
      </div>

      {/* Canvas */}
      <div className="flex-1 relative overflow-hidden">
        {nodes.map((node) => (
          <motion.div
            key={node.id}
            className="absolute cursor-pointer"
            initial={{ opacity: 0, scale: 0.8 }}
            animate={{ opacity: 1, scale: 1 }}
            style={{ top: node.y, left: node.x }}
          >
            <Card className={`w-48 h-24 border-2 ${node.ai!=="none"?'border-blue-400':'border-neutral-300'}`}> 
              <CardContent className="flex flex-col items-center justify-center h-full">
                <div className="font-semibold text-center">{node.name}</div>
                <div className="text-xs text-neutral-500">Lever: {node.lever}</div>
                <div className="text-xs text-neutral-500">AI: {node.ai}</div>
              </CardContent>
            </Card>
          </motion.div>
        ))}

        {/* Simple connectors */}
        <svg className="absolute top-0 left-0 w-full h-full pointer-events-none">
          <line x1="200" y1="200" x2="360" y2="200" stroke="#94a3b8" strokeWidth="2" markerEnd="url(#arrowhead)" />
          <line x1="480" y1="200" x2="640" y2="200" stroke="#94a3b8" strokeWidth="2" markerEnd="url(#arrowhead)" />
          <defs>
            <marker id="arrowhead" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto">
              <path d="M0,0 L0,6 L6,3 z" fill="#94a3b8" />
            </marker>
          </defs>
        </svg>
      </div>

      {/* Bottom metrics */}
      <div className="flex items-center justify-between p-3 border-t bg-white">
        <div className="flex items-center gap-3">
          <Brain className="w-4 h-4 text-blue-500" />
          <span className="text-sm text-neutral-700">Flow Score: 7 / Intelligence: 8 / Value: 6</span>
        </div>
        <div className="flex gap-2">
          <Button variant="outline" size="sm"><Network className="w-4 h-4 mr-1"/>Export JSON</Button>
          <Button size="sm"><Play className="w-4 h-4 mr-1"/>Simulate</Button>
        </div>
      </div>
    </div>
  );
}
